#include "demotex.h"

LOCAL BYTE sinTable[]={
	0x0000,0x0192,0x0324,0x04B6,0x0647,0x07D9,0x096A,0x0AFB,
	0x0C8B,0x0E1B,0x0FAB,0x1139,0x12C8,0x1455,0x15E2,0x176D,
	0x18F8,0x1A82,0x1C0B,0x1D93,0x1F19,0x209F,0x2223,0x23A6,
	0x2528,0x26A8,0x2826,0x29A3,0x2B1F,0x2C98,0x2E11,0x2F87,
	0x30FB,0x326E,0x33DE,0x354D,0x36BA,0x3824,0x398C,0x3AF2,
	0x3C56,0x3DB8,0x3F17,0x4073,0x41CE,0x4325,0x447A,0x45CD,
	0x471C,0x4869,0x49B4,0x4AFB,0x4C3F,0x4D81,0x4EBF,0x4FFB,
	0x5133,0x5269,0x539B,0x54CA,0x55F5,0x571D,0x5842,0x5964,
	0x5A82,0x5B9D,0x5CB4,0x5DC7,0x5ED7,0x5FE3,0x60EC,0x61F1,
	0x62F2,0x63EF,0x64E8,0x65DD,0x66CF,0x67BD,0x68A6,0x698C,
	0x6A6D,0x6B4A,0x6C24,0x6CF9,0x6DCA,0x6E96,0x6F5F,0x7023,
	0x70E2,0x719E,0x7255,0x7307,0x73B5,0x745F,0x7504,0x75A5,
	0x7641,0x76D9,0x776C,0x77FA,0x7884,0x7909,0x798A,0x7A05,
	0x7A7D,0x7AEF,0x7B5D,0x7BC5,0x7C29,0x7C89,0x7CE3,0x7D39,
	0x7D8A,0x7DD6,0x7E1D,0x7E5F,0x7E9D,0x7ED5,0x7F09,0x7F38,
	0x7F62,0x7F87,0x7FA7,0x7FC2,0x7FD8,0x7FE9,0x7FF6,0x7FFD,
	0x8000,0x7FFD,0x7FF6,0x7FE9,0x7FD8,0x7FC2,0x7FA7,0x7F87,
	0x7F62,0x7F38,0x7F09,0x7ED5,0x7E9D,0x7E5F,0x7E1D,0x7DD6,
	0x7D8A,0x7D39,0x7CE3,0x7C89,0x7C29,0x7BC5,0x7B5D,0x7AEF,
	0x7A7D,0x7A05,0x798A,0x7909,0x7884,0x77FA,0x776C,0x76D9,
	0x7641,0x75A5,0x7504,0x745F,0x73B5,0x7307,0x7255,0x719E,
	0x70E2,0x7023,0x6F5F,0x6E96,0x6DCA,0x6CF9,0x6C24,0x6B4A,
	0x6A6D,0x698C,0x68A6,0x67BD,0x66CF,0x65DD,0x64E8,0x63EF,
	0x62F2,0x61F1,0x60EC,0x5FE3,0x5ED7,0x5DC7,0x5CB4,0x5B9D,
	0x5A82,0x5964,0x5842,0x571D,0x55F5,0x54CA,0x539B,0x5269,
	0x5133,0x4FFB,0x4EBF,0x4D81,0x4C3F,0x4AFB,0x49B4,0x4869,
	0x471C,0x45CD,0x447A,0x4325,0x41CE,0x4073,0x3F17,0x3DB8,
	0x3C56,0x3AF2,0x398C,0x3824,0x36BA,0x354D,0x33DE,0x326E,
	0x30FB,0x2F87,0x2E11,0x2C98,0x2B1F,0x29A3,0x2826,0x26A8,
	0x2528,0x23A6,0x2223,0x209F,0x1F19,0x1D93,0x1C0B,0x1A82,
	0x18F8,0x176D,0x15E2,0x1455,0x12C8,0x1139,0x0FAB,0x0E1B,
	0x0C8B,0x0AFB,0x096A,0x07D9,0x0647,0x04B6,0x0324,0x0192
};

inline WORD16 integerSin(UWORD16 angle)

{
	return(sinTable[angle & 0xFF]);
}

inline WORD16 integerCos(UWORD16 angle)

{
	return(sinTable[(angle+0x80) & 0xFF]);	
}

PUBLIC VOID rotate(INPUT POINT *point, INPUT UWORD16 angle, OUTPUT POINT *transformed)

{
	UWORD16 i;
	UWORD16 sin=integerSin(angle);
	UWORD16 cos=integerCos(angle);
	POINT *tmpin=point;
	POINT *tmpout=transformed;

  for(i=0;i<4;i++,tmpin++,tmpout++) { 	
		rotatedx = tmpin->x*cos-tmpin->y*sin;
		rotatedy = tmpin->x*sin+tmpin->y*cos;
		tmpout->x=tmpx;
		tmpout->y=tmpy;
	}	
}